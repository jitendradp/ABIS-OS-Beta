<!-- todo add a timeslider https://docs.mapbox.com/mapbox-gl-js/example/timeline-animation/ -->
<!-- todo no reaction on the div container padding in the view of the map to push the controls more to the left -->
<!--
<mgl-map
  [style]="'mapbox://styles/mapbox/streets-v9'"
  [zoom]="[9]"
  [center]="[11.5116141, 48.1541385]">

  <div class="mapControlContainer">
    <mgl-control
      mglGeolocate>
    </mgl-control>
    <mgl-control
      mglNavigation>
    </mgl-control>
    <mgl-control
      mglScale
      unit="metric"
      position="bottom-right">
    </mgl-control>
  </div>
</mgl-map>
-->
<mgl-map
  [style]="mapStyle"
  [zoom]="[12]"
  [center]="[10.27739, 47.41156]">
  <mgl-control>
    <mat-slide-toggle (change)="mapStyleChanged($event)"></mat-slide-toggle>
  </mgl-control>
  <mgl-control
    mglGeolocate>
  </mgl-control>
  <mgl-control
    mglNavigation>
  </mgl-control>
  <mgl-control
    mglScale
    unit="metric"
    position="bottom-right">
  </mgl-control>

  <mgl-markers-for-clusters
    source="earthquakes">
    <ng-template mglPoint let-feature>
      <div
        class="marker"
        [title]="feature.properties['Primary ID']">
        {{ feature.properties['Secondary ID'] }}
      </div>
    </ng-template>
    <ng-template mglClusterPoint let-feature>
      <div
        class="marker-cluster"
        (click)="selectCluster($event, feature)">
        {{ feature.properties?.point_count }}
      </div>
    </ng-template>
  </mgl-markers-for-clusters>


  <ng-container *ngIf="dark">
    <mgl-geojson-source
      id="earthquakes"
      [data]="earthquakes"
      [cluster]="true"
      [clusterMaxZoom]="15"
      [clusterRadius]="20">
    </mgl-geojson-source>
    <mgl-layer
      *ngFor="let layer of clusterLayers"
      [id]="layer.id"
      type="circle"
      source="earthquakes"
      [filter]="layer.filter"
      [paint]="layer.paint"
      before="waterway-label">
    </mgl-layer>
    <mgl-layer
      id="unclustered-point"
      type="circle"
      source="earthquakes"
      [filter]="['!=', 'cluster', true]"
      [paint]="{
          'circle-color': 'rgba(0,255,0,0.5)',
          'circle-radius': 20,
          'circle-blur': 1
        }"
      before="waterway-label"
    ></mgl-layer>
  </ng-container>
</mgl-map>
